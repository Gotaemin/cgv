<?xml version="1.0" encoding="UTF-8"?>

<!DOCTYPE mapper
PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.tm.cgv.seatBooking.SeatBookingRepository">

	<select id="selectListByReservationNumZero" resultType="SeatBookingVO">
		SELECT DISTINCT seatNum FROM seatBooking WHERE movieTimeNum IN 
		(SELECT num FROM movieTime WHERE theaterNum = #{theaterNum}) AND reservationNum = 0;
	</select>

 	<insert id="seatBookingInsert" parameterType="SeatBookingVO">
		insert into seatBooking values(#{num},#{seatNum},#{movieTimeNum},#{reservationNum}) 	
 	</insert>
 	
 	<delete id="seatBookingDelete" parameterType="Integer">
 		delete from seatBooking where reservationNum=#{reservationNum}
 	</delete>
 	
 	<select id="selectCheckReservationNum" parameterType="Integer" resultType="Integer">
 		select seatNum from seatBooking where seatNum=#{seatNum}
 	</select>


	<insert id="insertReservationNum" parameterType="SeatBookingVO">
		insert into seatBooking (seatNum, movieTimeNum, reservationNum) values(#{seatNum}, #{movieTimeNum}, #{reservationNum}) 
	</insert>
	
	<update id="updateReservationNum" parameterType="SeatBookingVO">
		update seatBooking set reservationNum=#{reservationNum} where seatNum=#{seatNum}
	</update>
	
	<delete id="deleteReservationNum" parameterType="Integer">
		delete from seatBooking where seatNum=#{seatNum} and reservationNum=0
	</delete>
	
	
	<select id="selectMovieNum" parameterType="Integer" resultType="Integer">
		select movieNum from movieTime where theaterNum=#{theaterNum}
	</select>
	
	<select id="selectCheckExist" parameterType="SeatBookingVO" resultType="Integer">
		select num from seatBooking where seatNum=#{seatNum} and movieTimeNum=#{movieTimeNum}
	</select>

	<delete id="deletesByMovieTimeNum" parameterType="SeatBookingVO">
		DELETE FROM seatBooking WHERE movieTimeNum = #{movieTimeNum} 
	</delete>
	

</mapper>